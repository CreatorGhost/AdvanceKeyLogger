# E2E collector server configuration

e2e_server:
  key_store_path: "~/.advancekeylogger/keys/"
  storage_dir: "./server_data"
  max_payload_bytes: 10485760
  max_storage_mb: 1024
  retention_hours: 168
  replay_ttl_seconds: 3600
  replay_cache_max: 10000
  rate_limit_per_minute: 60
  auth_tokens:
    - "change-me"
  registration_tokens:
    - "register-me"
  # Set to true to allow any sender when allowed_client_keys is empty.
  # Default false = deny all unknown senders.
  allow_open_registration: false
  allowed_client_keys: []
  clients_file: "./server_data/clients.json"
  audit_log_path: "./server_data/audit.log"
  ssl_certfile: ""
  ssl_keyfile: ""
  key_rotation_hours: 0
  # Optional: provide private key directly (base64). If omitted, server will
  # load server_x25519_private from key_store_path.
  # server_private_key: ""
